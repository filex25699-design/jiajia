<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merry Christmas ä½³ä½³</title>
    <style>
        /* --- å…¨å±€æ ·å¼ --- */
        body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Arial', sans-serif;
            color: white;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- 1. å¼€å±å¼•å¯¼é¡µ (å¼ºåˆ¶ç”¨æˆ·ç‚¹å‡»ä»¥è§£é”å£°éŸ³) --- */
        #start-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s;
        }
        
        .start-btn {
            background: #c0392b;
            color: #fff;
            border: 2px solid #e74c3c;
            padding: 15px 40px;
            font-size: 20px;
            border-radius: 50px;
            cursor: pointer;
            animation: pulse 1.5s infinite;
            box-shadow: 0 0 20px rgba(192, 57, 43, 0.6);
            margin-top: 20px;
        }

        /* --- 2. ä¸»åœºæ™¯ --- */
        #snow-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        
        .scene {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0; /* åˆå§‹éšè—ï¼Œç‚¹å‡»å¼€å§‹åæ˜¾ç¤º */
            transition: opacity 1s;
        }

        /* éŸ³ä¹æ§åˆ¶æŒ‰é’® */
        .music-control {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            font-size: 24px; cursor: pointer;
            background: rgba(255,255,255,0.1); padding: 8px; border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.3);
        }
        .music-spin { animation: spin 3s linear infinite; }

        /* åœ£è¯æ ‘å®¹å™¨ */
        .tree-wrapper {
            position: relative;
            filter: drop-shadow(0 0 20px rgba(46, 204, 113, 0.4));
            animation: floatTree 4s ease-in-out infinite;
            cursor: pointer;
        }
        .tree-wrapper:active { transform: scale(0.95); }

        /* äº’åŠ¨åŒºåŸŸ */
        .footer-interactive {
            display: flex; justify-content: space-between; width: 320px; margin-top: -30px; position: relative; z-index: 20;
        }
        .character { width: 100px; height: 100px; cursor: pointer; transition: transform 0.2s; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5)); }
        .character:active { transform: scale(0.9); }
        .santa-svg { animation: hoverSanta 3s ease-in-out infinite alternate; }
        .gift-svg { animation: hoverGift 3.5s ease-in-out infinite alternate; }

        /* æ ‡é¢˜ */
        .title-text {
            font-family: 'Brush Script MT', cursive; font-size: 3.5rem; margin-top: 40px;
            background: linear-gradient(to right, #fff, #ffd700, #fff); -webkit-background-clip: text; color: transparent;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5); text-align: center;
        }

        /* --- å¼¹çª— --- */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 999; justify-content: center; align-items: center; backdrop-filter: blur(5px);
        }
        .letter-card {
            background: #fff; width: 80%; max-width: 350px; padding: 25px; border-radius: 15px;
            text-align: center; transform: scale(0.8); opacity: 0; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 4px solid #c0392b; box-shadow: 0 10px 40px rgba(0,0,0,0.6);
        }
        .modal-overlay.active .letter-card { transform: scale(1); opacity: 1; }
        .letter-card h3 { color: #c0392b; margin: 0 0 10px 0; font-size: 1.5rem; }
        .letter-card p { color: #333; font-size: 1.1rem; line-height: 1.6; }
        .close-btn { margin-top: 20px; background: #27ae60; color: white; border: none; padding: 10px 30px; border-radius: 20px; font-size: 1rem; cursor: pointer; }

        /* åŠ¨ç”» */
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes floatTree { 0% { transform: translateY(0); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0); } }
        @keyframes hoverSanta { 0% { transform: rotate(-2deg); } 100% { transform: rotate(2deg); } }
        @keyframes hoverGift { 0% { transform: rotate(2deg); } 100% { transform: rotate(-2deg); } }

        @media (max-width: 600px) { .scene { transform: scale(0.85); } .title-text { font-size: 2.8rem; } }
    </style>
</head>
<body>

    <div id="start-screen">
        <div style="font-size: 60px;">ğŸ’Œ</div>
        <p style="font-size: 18px; margin: 20px 0; color: #ddd;">ä½³ä½³ï¼Œæœ‰ä¸€ä»½åœ£è¯ç¤¼ç‰©è¯·æŸ¥æ”¶</p>
        <button class="start-btn" onclick="startExperience()">ç‚¹å‡»å¼€å¯</button>
    </div>

    <audio id="bgm" loop>
        <source src="https://music.163.com/song/media/outer/url?id=479400249.mp3" type="audio/mp3">
    </audio>
    
    <audio id="click-sound">
        <source src="data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWgAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBWAMAgDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uQZAAABiQk2QA0AAAAA0AAAAAAAE5QW8MAAAAAANAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uQZAABAAABAAAAAAAABAAAAAAAAAAAAQAAAAAAAAAAAAAAA" type="audio/mp3">
        </audio>

    <div id="music-icon" class="music-control" onclick="toggleMusic()">ğŸµ</div>
    <canvas id="snow-canvas"></canvas>

    <div class="scene" id="main-scene">
        <div class="tree-wrapper" onclick="playClickSound(); openModal('ğŸ„ åœ£è¯æ ‘', 'æ„¿è¿™æ£µæ ‘çš„æ˜Ÿå…‰<br>ç…§äº®ä½ æ–°çš„ä¸€å¹´<br>æ¯å¤©éƒ½å¼€å¼€å¿ƒå¿ƒï¼')">
            <svg width="300" height="380" viewBox="0 0 200 260">
                <rect x="90" y="220" width="20" height="40" fill="#5D4037" rx="2" />
                <path d="M20,230 Q100,260 180,230 L160,190 L180,190 Q100,220 20,190 L40,190 L20,230 Z" fill="#1B5E20" />
                <path d="M30,220 Q100,250 170,220 Q150,160 100,140 Q50,160 30,220" fill="#2E7D32" />
                <path d="M40,160 Q100,190 160,160 Q145,110 100,90 Q55,110 40,160" fill="#43A047" />
                <path d="M55,100 Q100,120 145,100 Q130,60 100,30 Q70,60 55,100" fill="#66BB6A" />
                <circle cx="70" cy="180" r="5" fill="#E74C3C" /><circle cx="140" cy="170" r="5" fill="#F1C40F" />
                <circle cx="90" cy="150" r="5" fill="#3498DB" /><circle cx="110" cy="200" r="6" fill="#FFF" opacity="0.8" />
                <g style="transform-origin: center; animation: pulse 2s infinite">
                    <path transform="translate(100, 30) scale(0.8)" d="M0,-15 L4,-4 L15,-4 L6,3 L9,14 L0,8 L-9,14 L-6,3 L-15,-4 L-4,-4 Z" fill="#FFD700" />
                </g>
            </svg>
        </div>

        <div class="footer-interactive">
            <div class="character santa-svg" onclick="playClickSound(); openModal('ğŸ… åœ£è¯è€äºº', 'HoHoHo~<br>ä¸ç®¡å¤–é¢å¤šå†·<br>æˆ‘éƒ½ä¼šç»™ä½ æœ€æš–çš„æ‹¥æŠ±ï¼')">
                <svg width="100" height="100" viewBox="0 0 100 100">
                    <path d="M20,40 Q50,10 80,40 L75,55 L25,55 Z" fill="#D32F2F" />
                    <circle cx="80" cy="40" r="8" fill="#FFF" />
                    <rect x="20" y="50" width="60" height="10" rx="5" fill="#FFF" />
                    <circle cx="50" cy="65" r="20" fill="#FFCCBC" />
                    <circle cx="43" cy="62" r="2" fill="#333" /><circle cx="57" cy="62" r="2" fill="#333" />
                    <path d="M30,70 Q50,95 70,70 Q75,75 70,85 Q50,100 30,85 Q25,75 30,70" fill="#FFF" />
                    <circle cx="50" cy="68" r="3" fill="#EF9A9A" />
                </svg>
            </div>
            <div class="character gift-svg" onclick="playClickSound(); openModal('ğŸ ç¥ç§˜ç¤¼ç‰©', 'å®ï¼å¥½è¿å·²åˆ°è´¦ï¼<br>ç¥æˆ‘ä»¬é¡ºé¡ºåˆ©åˆ©ï¼Œå¹³å¹³å®‰å®‰ï¼')">
                <svg width="90" height="90" viewBox="0 0 100 100">
                    <ellipse cx="50" cy="85" rx="35" ry="8" fill="rgba(0,0,0,0.3)" />
                    <rect x="20" y="40" width="60" height="45" rx="3" fill="#C0392B" />
                    <rect x="15" y="35" width="70" height="15" rx="2" fill="#E74C3C" />
                    <rect x="45" y="40" width="10" height="45" fill="#F1C40F" />
                    <circle cx="50" cy="35" r="8" fill="#F1C40F" />
                </svg>
            </div>
        </div>

        <div class="title-text">Merry Christmas</div>
    </div>

    <div class="modal-overlay" id="modalOverlay">
        <div class="letter-card">
            <h3 id="modalTitle"></h3>
            <p id="modalContent"></p>
            <button class="close-btn" onclick="closeModal()">æ”¶åˆ° â¤ï¸</button>
        </div>
    </div>

    <script>
        // --- æ ¸å¿ƒé€»è¾‘ï¼šéŸ³æ•ˆç³»ç»Ÿ ---
        const bgm = document.getElementById('bgm');
        const startScreen = document.getElementById('start-screen');
        const mainScene = document.getElementById('main-scene');
        const musicIcon = document.getElementById('music-icon');
        
        // åˆ›å»ºä¸€ä¸ªç®€å•çš„â€œå®â€å£° (ä½¿ç”¨ AudioContextï¼Œè¿™æ˜¯æœ€ç¨³çš„æ–¹å¼ï¼Œä¸éœ€è¦æ–‡ä»¶)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playClickSound() {
            // æ¯æ¬¡ç‚¹å‡»ç”Ÿæˆä¸€ä¸ªæ¸…è„†çš„ç”µå­éŸ³
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime); // é¢‘ç‡
            osc.frequency.exponentialRampToValueAtTime(300, audioCtx.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }

        // --- 1. ç‚¹å‡»â€œå¼€å¯â€æŒ‰é’®é€»è¾‘ ---
        function startExperience() {
            // 1. å°è¯•æ’­æ”¾èƒŒæ™¯éŸ³ä¹
            bgm.volume = 0.5;
            bgm.play().then(() => {
                musicIcon.classList.add('music-spin');
            }).catch(e => {
                console.log("è‡ªåŠ¨æ’­æ”¾è¢«æ‹¦æˆªï¼Œç­‰å¾…äº¤äº’");
                musicIcon.classList.remove('music-spin');
            });

            // 2. æ¿€æ´» AudioContext (ä¸ºç‚¹å‡»éŸ³æ•ˆåšå‡†å¤‡)
            if (audioCtx.state === 'suspended') audioCtx.resume();

            // 3. ç•Œé¢åˆ‡æ¢åŠ¨ç”»
            startScreen.style.opacity = '0';
            setTimeout(() => {
                startScreen.style.display = 'none';
                mainScene.style.opacity = '1';
            }, 800);
        }

        // --- 2. éŸ³ä¹å¼€å…³ ---
        function toggleMusic() {
            if (bgm.paused) {
                bgm.play();
                musicIcon.classList.add('music-spin');
                musicIcon.style.opacity = "1";
            } else {
                bgm.pause();
                musicIcon.classList.remove('music-spin');
                musicIcon.style.opacity = "0.5";
            }
        }

        // --- 3. å¼¹çª—æ§åˆ¶ ---
        const modal = document.getElementById('modalOverlay');
        const mTitle = document.getElementById('modalTitle');
        const mContent = document.getElementById('modalContent');

        function openModal(title, content) {
            mTitle.innerHTML = title;
            mContent.innerHTML = content;
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('active'), 10);
        }

        function closeModal() {
            playClickSound(); // å…³é—­ä¹Ÿå“ä¸€å£°
            modal.classList.remove('active');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        // --- 4. é›ªèŠ±ç‰¹æ•ˆ (ä¼˜åŒ–ç‰ˆ) ---
        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        let w, h;
        const snowflakes = [];
        
        function resize() { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize);
        resize();

        class Snowflake {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * w;
                this.y = Math.random() * -h;
                this.size = Math.random() * 2 + 1;
                this.speed = Math.random() * 1 + 0.5;
                this.opacity = Math.random() * 0.5 + 0.3;
            }
            update() {
                this.y += this.speed;
                if (this.y > h) this.reset();
                ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
                ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI*2); ctx.fill();
            }
        }
        for (let i = 0; i < 100; i++) snowflakes.push(new Snowflake());
        function animate() { ctx.clearRect(0,0,w,h); snowflakes.forEach(s => s.update()); requestAnimationFrame(animate); }
        animate();

    </script>
</body>
</html>
